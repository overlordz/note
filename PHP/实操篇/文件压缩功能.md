## 下载打包压缩文件功能实现

#### 实现逻辑如下：


```php

// 1、获取要打包的文件资源
$filepath = 'dir/';
$dirs = [];
if (is_dir($filepath)){
    $arr = scandir($filepath);
    foreach ($arr as $value) {
        if($value === '.' || $value === '..') {continue;}
        $dirs[] = $filepath.$value;
    }
}

// 2、实例化zipArchive类
$zip = new zipArchive();
//创建空的压缩包
$zipName = md5(uniqid() . time()) . '.zip';
//打开的方式来进行创建 若有则打开 若没有则进行创建
if($zip->open($zipName,  ZipArchive::CREATE | ZipArchive::OVERWRITE) === true){
    //循环将要下载的文件路径添加到压缩包
    foreach ($dirs as $v) {
        //addFile:第一个参数是将要添加的文件的完整路径，第二个参数是放到压缩包中的文件的名称
        $zip->addFile($v, basename($v));
    }
}
//关闭压缩包 注意：一定要进行关闭压缩包 否则将下载一个空的压缩包
$zip->close();

// 3、声明实现文件的下载
header('Content-Type:Application/zip');
header('Content-Disposition:attachment; filename=' . $zipName);
header('Content-Length:' . filesize($zipName));
readfile($zipName);
//删除生成的压缩文件
unlink($zipName);

```

