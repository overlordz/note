**问题：**



![dynamic.png](../../assets/php/arithmetic/dynamic.png)



**解答方式一：动态规划**

```php

<?php
error_reporting(E_ALL ^ E_NOTICE);
$t1 = microtime(true);

class bestMatch
{
    public function getMethod($postData)
    {
        $weightArr = $valueArr = $nameArr = [0];
        foreach ($postData['carDetail'] as $val) {
            //初始化各个物品重量和价值数组
            $weightArr[] = $val['technician'];
            $valueArr[] = $val['amount'];
            $nameArr[] = $val['type'];
        }

        //设置包最大重量为5
        $bagMax = $postData['pople'];
        $items = count($weightArr);
        // 价值列表
        $cacheMap[] = array_fill(1, $items, 0);
        // 套餐列表
        $cacheMapName[] = array_fill(1, $items, '');

        //中间的各种决策(依次放入物品a,b,c,d,e)
        for($i = 1; $i <= $bagMax; $i++)
        {
            for($j = 1; $j < $items; $j++)
            {
                $j_weight = $weightArr[$j];
                $j_value = $valueArr[$j];
                $j_name = $nameArr[$j];
                $j_prev_value = $cacheMap[$j-1][$i];
                $j_prev_name = $cacheMapName[$j-1][$i];
                if($j_weight > $i)
                {
                    $cacheMap[$j][$i] = $j_prev_value;
                    $cacheMapName[$j][$i] = $j_prev_name;
                }
                else
                {
                    // 剩余价值
                    if ($i-$j_weight >= 0) {
                        $surplus = $cacheMap[$j-1][$i-$j_weight];
                        $surplusName = $cacheMapName[$j-1][$i-$j_weight];
                    }else {
                        $surplus = 0;
                        $surplusName = '';
                    }
                    $j_extra_value = $j_value + $surplus;
                    $cacheMap[$j][$i] = max($j_prev_value, $j_extra_value);

                    if ($j_prev_value > $j_extra_value) {
                        $cacheMapName[$j][$i] = $j_prev_name;
                    }else{
                        $cacheMapName[$j][$i] = $j_name.'+'.$surplusName;
                    }
                }
            }
        }

        $actual = count($postData['carDetail']);
        return [
            'maxMatch' => $cacheMap[$actual][$bagMax],
            'maxMatchName' => trim($cacheMapName[$actual][$bagMax],'+')
        ];
    }
}

$bestMatch = new bestMatch;
$res = $bestMatch->getMethod($_POST);
$t2 = microtime(true);

echo '最佳金额: '.$res['maxMatch'].'<br/>';
echo '最佳套餐搭配: '.$res['maxMatchName'].'<br/>';
echo '耗时'.round($t2-$t1,7).'秒'.'<br/>' ;
echo '消耗内存: ' . memory_get_usage().'<br/>' ;
```



**解答方式二：递归**

```php
<?php

error_reporting(E_ALL ^ E_NOTICE);
$t1 = microtime(true);

class optimal
{
    public function getMatchList($array,$index = 0,$up =0,&$result =[])
    {
        for ($i=$index; $i < count($array); $i++) {
            if($index > 0 ){
                $value['name'] = $up['name'].'+'.$array[$i]['type'];
                $value['amount'] = bcadd($up['amount'],$array[$i]['amount'],2);
                $value['technician'] = bcadd($up['technician'],$array[$i]['technician']);
            }else{
                $value['name'] = $array[$i]['type'];
                $value['amount'] = bcadd($array[$i]['amount'],0,2);
                $value['technician'] = $array[$i]['technician'];
            }
            $result[]  = $value;
            $this->getMatchList($array,$i+1,$value,$result);
        }
        return $result ;

    }
}

$optimal = new optimal();
$people = $_POST['pople'];

$res = $optimal->getMatchList($_POST['carDetail']);
$bestMatch = [];
foreach ($res as $val) {
    if ($val['technician'] <= $people) {
        if ($bestMatch) {
            if ($val['amount'] > $bestMatch['amount']) {
                $bestMatch = $val;
            }
        }else{
            $bestMatch = $val;
        }
    }
}
$t2 = microtime(true);
echo '最佳金额: '.$bestMatch['amount'].'<br/>';
echo '最佳套餐搭配: '.$bestMatch['name'].'<br/>';
echo '耗时'.round($t2-$t1,7).'秒'.'<br/>' ;
echo '消耗内存: ' . memory_get_usage().'<br/>' ;

```

